<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Filipino Family Communication Adapter</title>
    <script src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
</head>
<body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
        const { useState } = React;

        const CommunicationTool = () => {
            const [inputMessage, setInputMessage] = useState('');
            const [adaptedMessages, setAdaptedMessages] = useState([]);
            const [selectedStyle, setSelectedStyle] = useState('all');

            const adaptMessage = (message) => {
                if (!message.trim()) return [];

                const adaptations = [
                    {
                        type: 'Direct & Respectful',
                        // FIX #1: Use lucide.createElement() and access icons via the global object
                        icon: lucide.createElement(lucide.MessageSquare, { className: "w-4 h-4" }),
                        color: 'bg-blue-50 border-blue-200',
                        message: convertToDirectRespectful(message),
                        context: 'Best for: Daily requests, routine changes',
                        timing: 'Good timing: After meals, during calm moments'
                    },
                    {
                        type: 'Visual Schedule Format',
                        icon: lucide.createElement(lucide.Clock, { className: "w-4 h-4" }),
                        color: 'bg-green-50 border-green-200',
                        message: convertToScheduleFormat(message),
                        context: 'Best for: Time-based requests, routine planning',
                        timing: 'Good timing: Morning planning, evening prep'
                    },
                    {
                        type: 'Simple Commands',
                        icon: lucide.createElement(lucide.Eye, { className: "w-4 h-4" }),
                        color: 'bg-purple-50 border-purple-200',
                        message: convertToSimpleCommands(message),
                        context: 'Best for: Immediate actions, safety concerns',
                        timing: 'Good timing: When attention is focused'
                    },
                    {
                        type: 'Whiteboard Format',
                        icon: lucide.createElement(lucide.FileText, { className: "w-4 h-4" }),
                        color: 'bg-orange-50 border-orange-200',
                        message: convertToWhiteboardFormat(message),
                        context: 'Best for: Complex instructions, reminders',
                        timing: 'Good timing: Leave up for reference'
                    }
                ];

                return selectedStyle === 'all' ? adaptations : adaptations.filter(a => a.type.toLowerCase().includes(selectedStyle));
            };

            const convertToDirectRespectful = (message) => {
                let adapted = message;
                
                adapted = adapted.replace(/can you please/gi, 'Please');
                adapted = adapted.replace(/would you mind/gi, 'Please');
                adapted = adapted.replace(/could you/gi, 'Please');
                
                if (!adapted.toLowerCase().includes('po') && !adapted.toLowerCase().includes('tatay')) {
                    adapted = 'Tatay, ' + adapted;
                }
                
                if (!adapted.toLowerCase().includes('salamat')) {
                    adapted += ' Salamat po.';
                }
                
                return adapted;
            };

            const convertToScheduleFormat = (message) => {
                let adapted = message;
                
                adapted = adapted.replace(/later/gi, 'after 7:00 PM');
                adapted = adapted.replace(/in the evening/gi, 'from 8:00-9:00 PM');
                adapted = adapted.replace(/when I'm done/gi, 'after I finish (30 minutes)');
                
                const lines = adapted.split('.').filter(line => line.trim());
                return lines.map((line, index) => `${index + 1}. ${line.trim()}`).join('\n');
            };

            const convertToSimpleCommands = (message) => {
                let adapted = message;
                
                const sentences = adapted.split(/[,;]|and(?!\s+the)/);
                const commands = sentences.map(sentence => {
                    let cmd = sentence.trim();
                    cmd = cmd.replace(/can you please|would you mind|could you/gi, '');
                    cmd = cmd.replace(/^\s*to\s+/gi, '');
                    return cmd.charAt(0).toUpperCase() + cmd.slice(1);
                });
                
                return commands.filter(cmd => cmd.length > 3).join('.\n') + '.';
            };

            const convertToWhiteboardFormat = (message) => {
                let adapted = message;
                
                adapted = adapted.toUpperCase();
                adapted = adapted.replace(/CAN YOU PLEASE|WOULD YOU MIND|COULD YOU/gi, 'â†’');
                
                const sections = adapted.split('.');
                return sections.map(section => {
                    if (section.trim()) {
                        return `ðŸ“‹ ${section.trim()}`;
                    }
                    return '';
                }).filter(s => s).join('\n\n');
            };

            const handleSubmit = () => {
                const adaptations = adaptMessage(inputMessage);
                setAdaptedMessages(adaptations);
            };

            const culturalTips = [
                "Use 'Tatay' to show respect and get attention",
                "Add 'po' for politeness in requests",
                "End with 'Salamat po' to show gratitude",
                "Be specific about times rather than vague",
                "Break complex requests into simple steps",
                "Use visual cues when possible",
                "Avoid American idioms and indirect language"
            ];

            return (
                <div className="max-w-4xl mx-auto p-6 bg-white">
                    <div className="mb-8">
                        <h1 className="text-3xl font-bold text-gray-800 mb-2">Filipino Family Communication Adapter</h1>
                        <p className="text-gray-600">Transform your messages for better understanding with your father</p>
                    </div>

                    <div className="grid grid-cols-1 lg:grid-cols-3 gap-6">
                        <div className="lg:col-span-2">
                            <div className="mb-6">
                                <label className="block text-sm font-medium text-gray-700 mb-2">Your Original Message:</label>
                                <textarea
                                    value={inputMessage}
                                    onChange={(e) => setInputMessage(e.target.value)}
                                    placeholder="Example: Can you please wait to clean the kitchen until I am done preparing my meals?"
                                    className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"
                                    rows="4"
                                />
                                
                                <div className="flex gap-4 mt-4">
                                    <select
                                        value={selectedStyle}
                                        onChange={(e) => setSelectedStyle(e.target.value)}
                                        className="p-2 border border-gray-300 rounded-lg"
                                    >
                                        <option value="all">All Styles</option>
                                        <option value="direct">Direct & Respectful</option>
                                        <option value="schedule">Schedule Format</option>
                                        <option value="simple">Simple Commands</option>
                                        <option value="whiteboard">Whiteboard Format</option>
                                    </select>
                                    
                                    <button
                                        onClick={handleSubmit}
                                        className="px-6 py-2 bg-blue-600 text-white font-semibold rounded-lg hover:bg-blue-700 transition-colors"
                                    >
                                        Adapt Message
                                    </button>
                                </div>
                            </div>

                            {adaptedMessages.length > 0 && (
                                <div className="space-y-4">
                                    <h2 className="text-xl font-semibold text-gray-800">Adapted Messages:</h2>
                                    {adaptedMessages.map((adaptation, index) => (
                                        <div key={index} className={`p-4 rounded-lg border-2 ${adaptation.color}`}>
                                            <div className="flex items-center gap-2 mb-2">
                                                {adaptation.icon}
                                                <h3 className="font-semibold text-gray-800">{adaptation.type}</h3>
                                            </div>
                                            
                                            <div className="bg-white p-3 rounded border mb-3">
                                                <pre className="whitespace-pre-wrap font-sans text-sm">{adaptation.message}</pre>
                                            </div>
                                            
                                            <div className="text-sm text-gray-600">
                                                <p className="font-medium">{adaptation.context}</p>
                                                <p className="italic">{adaptation.timing}</p>
                                            </div>
                                        </div>
                                    ))}
                                </div>
                            )}
                        </div>

                        <div className="space-y-6">
                            <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                                <div className="flex items-center gap-2 mb-3">
                                    {lucide.createElement(lucide.Lightbulb, { className: "w-5 h-5 text-yellow-600" })}
                                    <h3 className="font-semibold text-yellow-800">Cultural Communication Tips</h3>
                                </div>
                                <ul className="space-y-2 text-sm text-yellow-700 list-disc list-inside">
                                    {culturalTips.map((tip, index) => (
                                        <li key={index}>{tip}</li>
                                    ))}
                                </ul>
                            </div>

                             <div className="bg-green-50 border border-green-200 rounded-lg p-4">
                                <h3 className="font-semibold text-green-800 mb-3">Best Communication Times</h3>
                                <div className="space-y-2 text-sm text-green-700">
                                    <div><strong>Morning (8-10 AM):</strong> Planning, schedules</div>
                                    <div><strong>After meals:</strong> Requests, changes</div>
                                    <div><strong>Calm moments:</strong> Complex topics</div>
                                    <div><strong>Avoid:</strong> When he's focused on routines</div>
                                </div>
                            </div>

                            <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                                <h3 className="font-semibold text-blue-800 mb-3">Visual Presentation Tips</h3>
                                <ul className="space-y-1 text-sm text-blue-700 list-disc list-inside">
                                    <li>Use large, clear writing</li>
                                    <li>Leave whiteboard messages up</li>
                                    <li>Use simple drawings/icons</li>
                                    <li>Highlight key words</li>
                                    <li>Number steps clearly</li>
                                </ul>
                            </div>
                        </div>
                    </div>
                </div>
            );
        };

        // FIX #2: Use the modern React 18 createRoot API
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<CommunicationTool />);
    </script>
</body>
</html>
